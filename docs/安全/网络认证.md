# 网络认证

## WiFi 蜜罐

**WiFi 蜜罐** 是一种网络安全技术或攻击手段，其核心概念是伪装成一个看似安全的无线网络热点（Access Point, AP），以吸引设备连接。

### 伪装

*   **伪装 SSID：** 建立一个与知名公共热点或目标公司内部网络名称完全相同或极度相似的 WiFi 信号。
*   **信号增强：** 很多手机和电脑默认会连接信号最强的已知网络。
*   **自动连接：** 当受害者的设备搜索网络时，可能会误以为这是它曾经连接过的那个安全网络，从而自动连接上去。

### 中间人攻击（Man-in-the-Middle, MitM）

*   **数据窃取：** 一旦手机连接了蜜罐 WiFi，所有的网络流量都会经过黑客的设备。
*   **钓鱼攻击：** 当尝试打开网页时，可能会重定向到一个伪造的登录页面，诱使你输入账号密码。

## MAC 地址认证

**MAC 地址认证（Media Access Control Authentication）** 是一种基于网络设备物理地址的访问控制机制。它工作在 OSI 模型的第二层（数据链路层）。

### 原理

*   **白名单/黑名单机制：** 网络管理员在无线控制器（AC）或 RADIUS 服务器上维护一个允许接入的 MAC 地址列表（白名单）。当设备请求连接 WiFi 时，接入点（AP）会获取该设备的 MAC 地址并与列表比对。
*   **无感知认证：** 在很多商业 WiFi 场景（如酒店、办公区）中，用户首次通过 Portal 认证后，系统会记录其 MAC 地址。后续再次连接时，系统直接识别 MAC 地址放行，用户无需再次输入账号密码，实现“无感知”漫游。

### 安全缺陷与攻防

*   **MAC 地址嗅探（Sniffing）：** MAC 地址在无线数据帧头中是**明文传输**的（即使 WiFi 加了密，管理帧和控制帧中的 MAC 地址依然可见）。攻击者只需使用处于监听模式（Monitor Mode）的网卡，即可轻易捕获合法用户的 MAC 地址。
*   **MAC 地址欺骗（Spoofing）：** 攻击者可以通过`macchanger`将自己设备的网卡 MAC 修改为已捕获的合法用户 MAC。一旦合法用户下线或被攻击者强制断线（De-auth 攻击），攻击者即可冒充该设备接入网络，绕过白名单限制。

## WPA Enterprise (802.1X)

### 核心架构

*  **请求者（Supplicant）：** 用户设备（手机、笔记本电脑）。
*  **认证者（Authenticator）：** 无线接入点（AP）或无线控制器（AC）。它只负责透传认证信息，不保存密码。
*  **认证服务器（Authentication Server）：** 通常是 RADIUS 服务器（如 FreeRADIUS, Cisco ISE, Microsoft NPS）。它存储用户数据库并执行最终的验证逻辑。

### 认证协议

WPA Enterprise 使用 **EAP（Extensible Authentication Protocol，扩展认证协议）** 进行握手。常见的 EAP 类型包括：
*   **EAP-PEAP (Protected EAP)：** 先建立一个加密的 TLS 隧道（服务器需证书，客户端不需要），然后在隧道内验证用户名和密码（通常使用 MSCHAPv2）。
*   **EAP-TLS：** 安全性最高。**双向证书认证**，要求服务器和客户端都必须安装数字证书。
*   **EAP-TTLS：** 类似于 PEAP，但在隧道内支持更多种类的传统认证协议（如 PAP, CHAP）。

### 针对 WPA Enterprise 的攻击（Evil Twin 进阶）

针对 EAP-PEAP 的**大菠萝（WiFi Pineapple）类蜜罐攻击**：

*   **伪造证书攻击：** 攻击者建立一个同名的 WPA Enterprise 蜜罐（Evil Twin）。当受害者连接时，蜜罐提供一个伪造的服务器证书。
*   **配置不当的客户端：** 如果用户的设备配置为“不验证服务器证书”或用户习惯性点击“信任此证书”弹窗，受害者就会与蜜罐建立加密隧道。
*   **哈希捕获与破解：** 攻击者在隧道建立后，捕获用户发送的身份验证哈希值（Challenge/Response），随后离线使用 Hashcat 等工具暴力破解出用户的明文密码。