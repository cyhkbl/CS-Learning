# 网络基础

## 有线网

通过网线（以太网）或光纤连接到互联网的物理网络。可以通过物理接入窃听。

## 无线网

通过2.4GHz/5GHz频段的无线电波连接到互联网的网络。信号在空中传播，容易被监听。

## 网络配置

### Windows

输入命令：

```pwsh
ipconfig
```

### macOS / Linux

输入命令：

```bash
ifconfig
```

### Android/iOS

进入“设置” → “网络和互联网” → “Wi-Fi” → 选择已连接的网络 → 查看“高级”信息。

### 关键字段说明

以太网：有线网卡

蓝牙网络连接：蓝牙 PAN 网络

本地连接：通常是虚拟 Wi-Fi 适配器（例如 Wi-Fi Direct / 移动热点等）。

无线局域网适配器 WLAN：无线网卡

临时 IPv6 地址：为隐私设计的临时地址（会轮换），用于对外连接时减少被追踪。

本地链接 IPv6 地址：只在本链路有效（同一个二层网络里），不能跨路由。

## 网关

网关是内网通往互联网的出口。在家用网络里，它通常做这些事：

* **路由转发：**：把内网设备（手机/电脑）发出的数据，转发到互联网
* **NAT：**把内网私有 IP（比如 192.168.x.x）转换成公网出口
* **DHCP**：给内网设备自动分配 IP、网关、DNS
* 有时还会做防火墙、端口转发等

在电脑上看到的默认网关地址一般是 **192.168.1.1 / 192.168.0.1** 。这个地址是网络出口设备的内网地址。

### 光猫桥接(Bridge)：光猫不是网关

* 光猫只负责光电转换
* 由路由器拨号(PPPoE)并做 NAT/DHCP
* 网关是路由器（比如 192.168.1.1）

### 光猫作为路由(Router)：光猫是网关

* 光猫自己拨号并做 NAT/DHCP
* 路由器可能变成“二级路由”或“AP”
* 网关是光猫（电脑默认网关会指向光猫的地址）

### 查看当前局域网网关参数

#### 网关 IP

```pwsh
ipconfig
```

#### 网关 MAC 地址

```pwsh
ping your_gateway_ip #让系统把它写进 ARP 表
arp -a your_gateway_ip #查 ARP
```

有了 MAC 的前三组（OUI），就能大概率判断厂商（华为/锐捷/TP-Link/小米/思科等）。

#### 虚拟网关

`00-00-5E` 是标准组织 IANA 分配给一种虚拟路由协议的 MAC 地址空间，用于：

VRRP（Virtual Router Redundancy Protocol）

HSRP（思科的类似协议）

CARP（BSD 的版本）

这意味着所在网络是大规模企业网/校园网结构，网关可能由两台或多台路由设备组成。

#### 网关名称 / 设备名

```pwsh
nslookup your_gateway_ip
```

如果网络有 PTR 记录，可能会返回一个主机名；没有就会失败/返回 Unknown。

或：

```bat
ping -a your_gateway_ip
```

如果能解析，会显示类似 `Pinging router.local [your_gateway_ip]`；解析不了就只显示 IP。

或：
```pwsh
tracert 1.1.1.1
```

第一跳通常就是网关（可能显示名字或只显示 IP）。

## 子网掩码

子网掩码告诉电脑：**哪些位是“网络号”（同一局域网），哪些位是“主机号”（这台设备）**。它用来判断目标 IP 和本机是不是在**同一个子网/局域网**里。

例如，子网掩码：

`255.255.0.0` 等价于 **/16**（前 16 位是网络号）。例如，同一子网的范围是：`10.196.0.0` ~ `10.196.255.255`

`255.255.255.0` 等价于 **/24**（同网段 256 个地址左右）。

做按位与（AND）判断两台机器是否同一网段：网络号 = IP 地址 AND 子网掩码

例如：

* `10.196.69.101` AND `255.255.0.0` = `10.196.0.0`
* 如果另一台是 `10.196.8.20`
  `10.196.8.20` AND `255.255.0.0` 也是 `10.196.0.0`
  → 同网段
* 如果另一台是 `10.197.8.20`
  AND 后会变成 `10.197.0.0`
  → 不同网段，走网关

## IP地址

### IPv4

#### 局域网（RFC1918 私网段）

10.0.0.0 ~ 10.255.255.255（10/8）

172.16.0.0 ~ 172.31.255.255（172.16/12）

192.168.0.0 ~ 192.168.255.255（192.168/16）

169.254.0.0/16：APIPA 自动地址（没拿到 DHCP 时）

100.64.0.0/10：运营商 CGNAT 内网（不是局域网，也不是公网）

#### ARP

ARP（Address Resolution Protocol，地址解析协议）可以在 **IPv4 局域网** 里把IP 地址翻译成MAC 地址。**ARP 只在同一二层网络/广播域里有效。**

当你的电脑要访问同网段的某个 IPv4 目标：

如果在同一子网，它需要对方的 **MAC 地址** 才能发以太网帧。

1. 它会广播一个 **ARP Request**：
2. 目标主机会回一个 **ARP Reply**：
3. 电脑把这个映射缓存起来（ARP 缓存/ARP 表），之后一段时间内就不用再问了。

如果访问的目标 **不在同一子网**：

1. 电脑不会去 ARP 8.8.8.8（它不在本地局域网，ARP 广播也到不了它）
2. 它会把包交给 **默认网关**
3. 通过默认网关的IP地址去ARP默认网关的MAC地址
4. 然后把以太网帧发给网关，由网关帮你转发到外网。

### IPv6

#### 局域网

前缀：

`fe80::/10` —— **链路本地地址（Link-Local）**

* 只能在同一个二层网络里用（同一个 Wi-Fi/交换机这一跳）
* **一定是“本地/局域网意义上的地址”**

`fc00::/7`（常见 `fdxx:`）—— **IPv6 私网/ULA（Unique Local Address）**

* 类似 IPv4 的私网（不应在公网路由）
* 类似于`fd12:3456:...`一般就是“内网 IPv6”。

`2000::/3` —— **全球单播地址（Global Unicast）公网 IPv6**

* 大多数公网 IPv6 都在这个范围（2xxx/3xxx 开头）
* 你的是：`2408:8642:...`（2408 开头属于 2000::/3 范围）

`::1` —— 本机回环（Loopback）

* 指本机。

