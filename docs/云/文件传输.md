# 文件传输

## 使用 SCP 命令

如果你使用的是 Windows 10 或 11，自带的 **PowerShell** 或 **CMD** 已经内置了 `scp` 工具。在本地 Windows 上打开 PowerShell。输入以下命令：

```bash
scp 用户名@云服务器IP:/文件所在路径/压缩包名称.zip C:\本地保存路径\
```

例如：`scp Henry@4.240.102.224:~/rootfs.tar.gz D:\`

## 使用图形化工具

* **WinSCP / FileZilla：**
1. 下载并安装 [WinSCP](https://winscp.net/) 或 [FileZilla](https://filezilla-project.org/)。
2. 新建站点，协议选择 **SFTP** (端口默认为 22)。
3. 输入云服务器的 IP、用户名和密码。
4. 连接成功后，左侧是本地电脑，右侧是云服务器。直接将压缩包从右侧**拖拽**到左侧即可。

## 使用 Xshell / SecureCRT 的 ZMODEM (适合小文件)

如果通过 Xshell 或 SecureCRT 连接服务器，可以使用 `rz/sz` 命令。

1. **在服务器上安装工具：**
* Ubuntu/Debian: `sudo apt install lrzsz`
* CentOS/RHEL: `yum install lrzsz`

2. **发送文件：**
* 在终端输入：`sz 压缩包名称.zip`

3. **接收：** 弹出的 Windows 保存窗口中选择存放位置即可。
> **注意：** 该方法适合较小的压缩包，如果是几个 GB 的大文件，速度较慢且容易断开。

## 使用 VS Code

如果你通过 VS Code 的 **Remote - SSH** 插件连接服务器：

1. 在左侧的文件资源管理器中找到该压缩包。
2. **右键**点击该文件。
3. 选择 **Download (下载)**。
4. 在弹出的本地窗口中选择保存位置。

## 使用Azcopy

### 在 Azure 门户创建存储容器并获取 SAS

1. 在 Azure 门户创建一个 **存储账户 (Storage Account)**（如果已有则跳过）。
2. 进入存储账户 -> **容器 (Containers)** -> 新建一个容器（例如叫 `transfer`）。
3. 点击左侧菜单栏的 **共享访问签名 (Shared access signature)**：
* 勾选服务、容器、对象。
* 勾选所有权限（读取、写入、列表等）。
* 设置一个过期时间。
* 点击“生成 SAS 和连接字符串”，复制 **Blob 服务 SAS URL**。

### 从 Azure VM 上传文件到存储

在 Azure VM 终端执行：

```bash
# 格式：azcopy copy "本地路径" "SAS_URL/容器名/文件名"
azcopy copy "~/rootfs.tar.gz" "https://<你的账户名>.blob.core.windows.net/transfer/rootfs.tar.gz?<SAS令牌>"
```

### 从本地 Windows 下载到 D 盘

```powershell
# 格式：azcopy copy "SAS_URL/容器名/文件名" "本地路径"
azcopy copy "https://<你的账户名>.blob.core.windows.net/transfer/rootfs.tar.gz?<SAS令牌>" "D:\rootfs.tar.gz"
```