# 生物医学信号处理

## 噪声

> 混在有用生物信号里的、无关或干扰成分。

## 滤波

> 保留感兴趣的频率成分，抑制或去除其他成分。

- 低通滤波：去高频噪声           
- 高通滤波：去低频漂移           
- 带通滤波：只保留某一频段         
- 带阻滤波：去除特定频率

## 采样

> 按固定时间间隔对连续时间信号取值，把**模拟信号转换为数字信号**

### 采样定理

> **采样频率 ≥ 信号最高频率的 2 倍**

否则会出现 **混叠**。

### Nyquist 频率

> **Nyquist 频率 = 采样频率 / 2**

**采样系统能够无失真地还原的最高信号频率**。任何高于这个频率的成分，在采样后都会发生畸变。因此，**被采样信号本身的最高频率成分必须小于 Nyquist 频率**。

## 混叠

> 当**采样频率低于信号最高频率的 2 倍**时，高频成分会被错误地表现为低频成分，导致信号失真。

采样后，频谱会以 fs 为周期重复，超出 fs/2 的部分会**折叠回低频**。

混叠后的频率：

f(alias) = |f（实际） - k * fs|，并且要保证 f(alias) 落在 **0 Hz 到 Nyquist 频率** 这个范围内。

### 抗混叠滤波器

> **采样前**加一个**低通滤波器**，其截止频率设定在 Nyquist 频率以下，将所有高于 Nyquist 频率的成分**在采样前就彻底滤除**。

## 处理流程

> 生物信号 → 含噪信号 → 滤波 → 采样 → 数字信号处理

## ECG

**心脏在跳动过程中产生的电活动信号**，通过贴在皮肤表面的电极采集。

* **周期性**（与心跳一致）
* **幅值**：约 **0.5–5 mV**
* **频率范围**：**0.05–150 Hz**

### 波形

* **P 波**：心房去极化，即心房肌细胞兴奋并引发心房收缩。特点：幅度较小、频率成分较低、在 ECG 中容易被噪声掩盖。
* **QRS 波群**：心室去极化。特点：幅度大、上升沿陡峭、高频成分丰富（约 10–25 Hz）。
* **T 波**：心室复极化。特点：斜率平缓、高频成分较少、波形结束点（T 波终点）界定困难。

### 去噪

* 工频干扰（50 Hz / 60 Hz）：来源于电力系统。可通过带阻滤波抑制工频干扰，但在 QRS 复合波存在时，线性滤波器可能引入失真，因此在某些情况下需要采用非线性或自适应滤波方法
* 肌电干扰：来自骨骼肌活动。利用 ECG 的周期性，对齐多个心搏后进行集合平均（ensemble averaging）可以有效降低非同步噪声成分。
* 基线漂移：来源于呼吸、体动，低频噪声，通常低于 0.5 Hz，通过高通滤波、多采样率方法或样条拟合等方式加以去除

### R 峰检测

R 峰是 QRS 复合波中幅度最大的正峰，是心搏时间定位的基准点。ECG 中几乎所有时间参数（RR 间期、心率变异性等）都以 R 峰为参考。

### 心率变异性（HRV）分析

### 心电分类（正常 / 房颤 / 室早等）

### 心率

Heart Rate (bpm)=60/RR interval (s)

工程上我们不是直接算心率，而是先稳定地检测 R 峰，再从 RR 间期得到心率。”

## EEG

**大脑神经元群体活动产生的微弱电信号**，通过头皮电极采集。

* **非平稳、随机性强**
* **幅值**：约 **10–100 μV**
* **主要频率范围**：**0.1–100 Hz**

### 节律

| 频段       | 频率       | 含义    |
| -------- | -------- | ----- |
| δ（Delta） | 0.5–4 Hz | 深度睡眠  |
| θ（Theta） | 4–8 Hz   | 困倦、冥想 |
| α（Alpha） | 8–13 Hz  | 放松、闭眼 |
| β（Beta）  | 13–30 Hz | 思考、紧张 |
| γ（Gamma） | >30 Hz   | 高级认知  |

### 去噪

* 眼电（眨眼、眼动）
* 肌电（咀嚼、说话）
* 电极接触不良

### 时频分析（STFT / 小波）

### 特征提取（功率谱、熵）

### 脑电分类与解码